{"version":3,"file":"index.js","sources":["../src/scripts/utils/maths.js","../src/index.js"],"sourcesContent":["export function clamp(min, input, max) {\n  return input < min ? min : input > max ? max : input\n}\n\nexport function mapRange(in_min, in_max, input, out_min, out_max) {\n  return ((input - in_min) * (out_max - out_min)) / (in_max - in_min) + out_min\n}\n\nexport function lerp(start, end, amt) {\n  return (1 - amt) * start + amt * end\n}\n\nexport function truncate(value, decimals) {\n  return parseFloat(value.toFixed(decimals))\n}\n","import { lerp, truncate } from './scripts/utils/maths'\n// import { offsetLeft, offsetTop } from \"./scripts/utils/rect\"\nimport EventEmitter from 'events'\n\nfunction getTranslate(element) {\n  const matrix = new DOMMatrixReadOnly(\n    window.getComputedStyle(element).getPropertyValue('transform')\n  )\n\n  return {\n    translateX: matrix.m41,\n    translateY: matrix.m42,\n  }\n}\n\nclass BoundingClientRect {\n  constructor(element) {\n    this.element = element\n    this.update()\n  }\n\n  update() {\n    const { width, height, top, left } = this.element.getBoundingClientRect()\n    this.width = width\n    this.height = height\n\n    // this.offsetTop = offsetTop(this.element)\n    // this.offsetLeft = offsetLeft(this.element)\n\n    const { translateX, translateY } = getTranslate(this.element)\n\n    this.offsetTop = top - translateY\n    this.offsetLeft = left - translateX\n  }\n}\n\nclass Scrollbar {\n  constructor() {\n    this.element = document.createElement('div')\n    this.thumb = document.createElement('div')\n\n    this.element.classList.add('lenis-scrollbar')\n    this.thumb.classList.add('lenis-scrollbar-thumb')\n\n    this.element.appendChild(this.thumb)\n\n    document.body.appendChild(this.element)\n\n    this.onWindowResize()\n\n    window.addEventListener('resize', this.onWindowResize, false)\n  }\n\n  update() {\n    this.height = this.thumb.offsetHeight\n  }\n\n  onWindowResize = () => {\n    this.windowWidth = Math.min(\n      document.documentElement.clientWidth,\n      window.innerWidth\n    )\n    this.windowHeight = Math.min(\n      document.documentElement.clientHeight,\n      window.innerHeight\n    )\n\n    this.update()\n  }\n\n  transform(progress) {\n    this.thumb.style.transform = `translateY(${\n      progress * (this.windowHeight - this.height) + 'px'\n    })`\n  }\n}\n\nexport default class Lenis extends EventEmitter {\n  constructor({\n    wrapper,\n    content,\n    lerp = 0.1,\n    smooth = true,\n    customScrollbar = true,\n  }) {\n    super()\n    this.setMaxListeners(Infinity)\n\n    this.customScrollbar = customScrollbar\n    this.smooth = smooth\n    this.lerp = lerp\n    this.wrapper = wrapper\n    this.content = content\n\n    //prevent scroll go to 0 when on page refresh\n    this.height = this.content.offsetHeight\n    if (this.smooth) document.body.style.height = this.height + 'px'\n\n    this.wrapper.setAttribute('data-scroll-wrapper', true)\n    this.content.setAttribute('data-scroll-content', true)\n\n    document.documentElement.classList.add('lenis')\n    document.documentElement.classList.toggle('lenis-smooth', this.smooth)\n    document.documentElement.classList.toggle(\n      'lenis-custom-scrollbar',\n      this.customScrollbar\n    )\n\n    this.preventTransforms = false\n\n    if (this.customScrollbar) this.scrollbar = new Scrollbar()\n\n    this.sections = [...document.querySelectorAll('[data-scroll-section]')].map(\n      (element) => new BoundingClientRect(element)\n    )\n\n    this.onWindowResize()\n\n    window.addEventListener('scroll', this.onWindowScroll, false)\n    window.addEventListener('resize', this.onWindowResize, false)\n\n    // supports TAB focus\n    window.addEventListener('keydown', this.onKeyDown, false)\n\n    // supports CMD+F focus\n    this.focus = true\n    // window.addEventListener(\"wheel\", this.onWheel, false)\n    window.addEventListener('focus', this.onFocus, false)\n    window.addEventListener('blur', this.onBlur, false)\n  }\n\n  onKeyDown = (e) => {\n    if (e.key === 'Tab') {\n      this.applyTransforms(true)\n    }\n  }\n\n  // onWheel = () => {\n  //   console.log(\"on wheel\")\n  //   this.focus = true\n  // }\n\n  onFocus = () => {\n    this.focus = true\n    this.applyTransforms(true)\n  }\n\n  onBlur = () => {\n    this.focus = false\n    this.applyTransforms(true)\n  }\n\n  destroy() {\n    document.body.style.removeProperty('height')\n\n    window.removeEventListener('scroll', this.onWindowScroll, false)\n    window.removeEventListener('resize', this.onWindowResize, false)\n    window.removeEventListener('keydown', this.onKeyDown, false)\n    // window.removeEventListener(\"wheel\", this.onWheel, false)\n    window.removeEventListener('focus', this.onFocus, false)\n    window.removeEventListener('blur', this.onBlur, false)\n\n    this.wrapper.removeAttribute('data-scroll-wrapper', true)\n    this.content.removeAttribute('data-scroll-content', true)\n\n    document.documentElement.classList.remove('lenis')\n    document.documentElement.classList.remove('lenis-smooth')\n  }\n\n  update() {\n    this.height = this.content.offsetHeight\n\n    if (this.smooth) document.body.style.height = this.height + 'px'\n\n    this.scroll = {\n      x: window.scrollX,\n      y: window.scrollY,\n    }\n    this.lerpedScroll = {\n      x: window.scrollX,\n      y: window.scrollY,\n    }\n\n    if (this.scrollbar) this.scrollbar.update()\n\n    this.sections.forEach((section) => {\n      section.update()\n    })\n\n    this.emit('scroll', {\n      scroll: this.scroll,\n      lerpedScroll: this.lerpedScroll,\n    })\n\n    this.applyTransforms(true)\n  }\n\n  onWindowResize = () => {\n    this.windowWidth = Math.min(\n      document.documentElement.clientWidth,\n      window.innerWidth\n    )\n    this.windowHeight = Math.min(\n      document.documentElement.clientHeight,\n      window.innerHeight\n    )\n    this.update()\n  }\n\n  onWindowScroll = () => {\n    this.scroll.x = window.scrollX\n    this.scroll.y = window.scrollY\n\n    if (this.focus === false || this.smooth === false) {\n      this.lerpedScroll.x = this.scroll.x\n      this.lerpedScroll.y = this.scroll.y\n\n      this.applyTransforms(true)\n    }\n  }\n\n  raf() {\n    let needsUpdate = false\n\n    if (truncate(this.lerpedScroll.y, 0) === this.scroll.y) {\n      // stop on the exact scroll value\n      this.lerpedScroll.x = this.scroll.x\n      this.lerpedScroll.y = this.scroll.y\n\n      if (!this.preventTransforms) {\n        needsUpdate = true\n        this.preventTransforms = true\n      }\n    } else {\n      this.lerpedScroll.x = lerp(this.lerpedScroll.x, this.scroll.x, this.lerp)\n      this.lerpedScroll.y = lerp(this.lerpedScroll.y, this.scroll.y, this.lerp)\n\n      needsUpdate = true\n      this.preventTransforms = false\n    }\n\n    if (needsUpdate) {\n      this.emit('scroll', {\n        scroll: this.scroll,\n        lerpedScroll: this.lerpedScroll,\n      })\n      this.applyTransforms()\n    }\n  }\n\n  applyTransforms(force = false) {\n    if (this.scrollbar) this.scrollbar.transform(this.progress)\n\n    if (this.smooth === true) {\n      if (this.sections.length > 0) {\n        this.sections.forEach(({ offsetTop, height, element }) => {\n          const top = offsetTop - this.lerpedScroll.y\n          const bottom = top + height\n\n          const OFFSET = 500\n\n          if (force || (top < this.windowHeight + OFFSET && bottom > -OFFSET)) {\n            // element.style.removeProperty(\"opacity\")\n            // element.style.removeProperty(\"pointerEvents\")\n            element.style.transform = `translate3d(0,${-this.lerpedScroll\n              .y}px,0)`\n          }\n          // else {\n          // element.style.removeProperty(\"transform\")\n          // element.style.opacity = 0\n          // element.style.pointerEvents = \"none\"\n          // }\n        })\n      } else {\n        this.content.style.transform = `translate3d(0,${-this.lerpedScroll\n          .y}px,0)`\n      }\n    }\n  }\n\n  get progress() {\n    return this.lerpedScroll.y / (this.height - this.windowHeight)\n  }\n}\n"],"names":["lerp","start","end","amt","truncate","value","decimals","parseFloat","toFixed","getTranslate","element","matrix","DOMMatrixReadOnly","window","getComputedStyle","getPropertyValue","translateX","m41","translateY","m42","BoundingClientRect","constructor","this","update","width","height","top","left","getBoundingClientRect","offsetTop","offsetLeft","Scrollbar","document","createElement","thumb","classList","add","appendChild","body","onWindowResize","addEventListener","offsetHeight","windowWidth","Math","min","documentElement","clientWidth","innerWidth","windowHeight","clientHeight","innerHeight","transform","progress","style","Lenis","EventEmitter","wrapper","content","smooth","customScrollbar","super","setMaxListeners","Infinity","setAttribute","toggle","preventTransforms","scrollbar","sections","querySelectorAll","map","onWindowScroll","onKeyDown","focus","onFocus","onBlur","e","key","applyTransforms","destroy","removeProperty","removeEventListener","removeAttribute","remove","scroll","x","scrollX","y","scrollY","lerpedScroll","forEach","section","emit","raf","let","needsUpdate","force","length"],"mappings":"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"}