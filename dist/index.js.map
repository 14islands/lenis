{"version":3,"file":"index.js","sources":["../src/scripts/utils/maths.js","../src/index.js"],"sourcesContent":["export function clamp(min, input, max) {\n  return input < min ? min : input > max ? max : input\n}\n\nexport function mapRange(in_min, in_max, input, out_min, out_max) {\n  return ((input - in_min) * (out_max - out_min)) / (in_max - in_min) + out_min\n}\n\nexport function lerp(start, end, amt) {\n  return (1 - amt) * start + amt * end\n}\n\nexport function truncate(value, decimals) {\n  return parseFloat(value.toFixed(decimals))\n}\n","import { lerp, truncate } from './scripts/utils/maths'\n// import { offsetLeft, offsetTop } from \"./scripts/utils/rect\"\nimport EventEmitter from 'events'\n\nfunction getTranslate(element) {\n  const matrix = new DOMMatrixReadOnly(\n    window.getComputedStyle(element).getPropertyValue('transform')\n  )\n\n  return {\n    translateX: matrix.m41,\n    translateY: matrix.m42,\n  }\n}\n\nclass BoundingClientRect {\n  constructor(element) {\n    this.element = element\n    this.update()\n  }\n\n  update() {\n    const { width, height, top, left } = this.element.getBoundingClientRect()\n    this.width = width\n    this.height = height\n\n    // this.offsetTop = offsetTop(this.element)\n    // this.offsetLeft = offsetLeft(this.element)\n\n    const { translateX, translateY } = getTranslate(this.element)\n\n    this.offsetTop = top - translateY\n    this.offsetLeft = left - translateX\n  }\n}\n\nclass Scrollbar {\n  constructor(lenis) {\n    this.lenis = lenis\n\n    this.element = document.createElement('div')\n    this.thumb = document.createElement('div')\n\n    this.element.classList.add('lenis-scrollbar')\n    this.thumb.classList.add('lenis-scrollbar-thumb')\n\n    this.element.appendChild(this.thumb)\n\n    document.body.appendChild(this.element)\n\n    this.onWindowResize()\n\n    window.addEventListener('resize', this.onWindowResize, false)\n    this.element.addEventListener('mousedown', this.onMouseDown, false)\n    window.addEventListener('mousemove', this.onMouseMove, false)\n    window.addEventListener('mouseup', this.onMouseUp, false)\n  }\n\n  onMouseDown = ({ clientY }) => {\n    this.mouseDown = true\n\n    const progress = clientY / this.windowHeight\n\n    window.scrollTo(0, progress * this.lenis.limit)\n  }\n\n  onMouseMove = ({ clientY }) => {\n    if (!this.mouseDown) return\n\n    const progress = clientY / this.windowHeight\n\n    window.scrollTo(0, progress * this.lenis.limit)\n  }\n\n  onMouseUp = () => {\n    this.mouseDown = false\n  }\n\n  destroy() {\n    window.removeEventListener('resize', this.onWindowResize, false)\n    this.element.removeEventListener('mousedown', this.onMouseDown, false)\n    window.removeEventListener('mousemove', this.onMouseMove, false)\n    window.removeEventListener('mouseup', this.onMouseUp, false)\n  }\n\n  update() {\n    this.height = this.thumb.offsetHeight\n  }\n\n  onWindowResize = () => {\n    this.windowWidth = Math.min(\n      document.documentElement.clientWidth,\n      window.innerWidth\n    )\n    this.windowHeight = Math.min(\n      document.documentElement.clientHeight,\n      window.innerHeight\n    )\n\n    this.update()\n  }\n\n  transform(progress) {\n    this.thumb.style.transform = `translateY(${\n      progress * (this.windowHeight - this.height) + 'px'\n    })`\n  }\n}\n\nexport default class Lenis extends EventEmitter {\n  constructor({\n    wrapper,\n    content,\n    lerp = 0.1,\n    smooth = true,\n    customScrollbar = true,\n    debug = false,\n  }) {\n    super()\n    this.setMaxListeners(Infinity)\n\n    this.customScrollbar = customScrollbar\n    this.smooth = smooth\n    this.lerp = lerp\n    this.wrapper = wrapper\n    this.content = content\n    this.debug = debug\n\n    //prevent scroll go to 0 when on page refresh\n    this.height = this.content.offsetHeight\n    if (this.smooth) document.body.style.height = this.height + 'px'\n\n    this.wrapper.setAttribute('data-scroll-wrapper', true)\n    this.content.setAttribute('data-scroll-content', true)\n\n    document.documentElement.classList.add('lenis')\n    document.documentElement.classList.toggle('lenis-smooth', this.smooth)\n\n    this.preventTransforms = false\n\n    if (this.customScrollbar) this.scrollbar = new Scrollbar(this)\n\n    this.onWindowResize()\n\n    window.addEventListener('scroll', this.onWindowScroll, false)\n    window.addEventListener('resize', this.onWindowResize, false)\n\n    // supports TAB focus\n    window.addEventListener('keydown', this.onKeyDown, false)\n\n    // supports CMD+F focus\n    this.focus = true\n    // window.addEventListener(\"wheel\", this.onWheel, false)\n    window.addEventListener('focus', this.onFocus, false)\n    window.addEventListener('blur', this.onBlur, false)\n  }\n\n  onKeyDown = (e) => {\n    if (e.key === 'Tab') {\n      this.applyTransforms(true)\n    }\n  }\n\n  // onWheel = () => {\n  //   console.log(\"on wheel\")\n  //   this.focus = true\n  // }\n\n  onFocus = () => {\n    if (this.debug) console.log('Lenis onFocus')\n\n    this.focus = true\n    this.applyTransforms(true)\n  }\n\n  onBlur = () => {\n    if (this.debug) console.log('Lenis onBlur')\n\n    this.focus = false\n    this.applyTransforms(true)\n  }\n\n  destroy() {\n    document.body.style.removeProperty('height')\n\n    window.removeEventListener('scroll', this.onWindowScroll, false)\n    window.removeEventListener('resize', this.onWindowResize, false)\n    window.removeEventListener('keydown', this.onKeyDown, false)\n    // window.removeEventListener(\"wheel\", this.onWheel, false)\n    window.removeEventListener('focus', this.onFocus, false)\n    window.removeEventListener('blur', this.onBlur, false)\n\n    this.wrapper.removeAttribute('data-scroll-wrapper', true)\n    this.content.removeAttribute('data-scroll-content', true)\n\n    document.documentElement.classList.remove('lenis')\n    document.documentElement.classList.remove('lenis-smooth')\n\n    if (this.scrollbar) this.scrollbar.destroy()\n  }\n\n  update() {\n    if (this.debug) console.log('Lenis update')\n    this.height = this.content.offsetHeight\n\n    if (this.smooth) document.body.style.height = this.height + 'px'\n\n    this.scroll = {\n      x: window.scrollX,\n      y: window.scrollY,\n    }\n    this.lerpedScroll = {\n      x: window.scrollX,\n      y: window.scrollY,\n    }\n\n    if (this.scrollbar) this.scrollbar.update()\n\n    this.sections = [...document.querySelectorAll('[data-scroll-section]')].map(\n      (element) => new BoundingClientRect(element)\n    )\n\n    this.sections.forEach((section) => {\n      section.update()\n    })\n\n    this.emit('scroll', {\n      scroll: this.scroll,\n      lerpedScroll: this.lerpedScroll,\n    })\n\n    this.applyTransforms(true)\n  }\n\n  onWindowResize = () => {\n    if (this.debug) console.log('Lenis onWindowResize')\n\n    this.windowWidth = Math.min(\n      document.documentElement.clientWidth,\n      window.innerWidth\n    )\n    this.windowHeight = Math.min(\n      document.documentElement.clientHeight,\n      window.innerHeight\n    )\n    this.update()\n  }\n\n  onWindowScroll = () => {\n    this.scroll.x = window.scrollX\n    this.scroll.y = window.scrollY\n\n    if (this.focus === false || this.smooth === false) {\n      this.lerpedScroll.x = this.scroll.x\n      this.lerpedScroll.y = this.scroll.y\n\n      this.applyTransforms(true)\n    }\n  }\n\n  raf() {\n    let needsUpdate = false\n\n    if (truncate(this.lerpedScroll.y, 0) === this.scroll.y) {\n      // stop on the exact scroll value\n      this.lerpedScroll.x = this.scroll.x\n      this.lerpedScroll.y = this.scroll.y\n\n      if (!this.preventTransforms) {\n        needsUpdate = true\n        this.preventTransforms = true\n      }\n    } else {\n      this.lerpedScroll.x = lerp(this.lerpedScroll.x, this.scroll.x, this.lerp)\n      this.lerpedScroll.y = lerp(this.lerpedScroll.y, this.scroll.y, this.lerp)\n\n      needsUpdate = true\n      this.preventTransforms = false\n    }\n\n    if (needsUpdate) {\n      this.emit('scroll', {\n        scroll: this.scroll,\n        lerpedScroll: this.lerpedScroll,\n      })\n      this.applyTransforms()\n    }\n  }\n\n  applyTransforms(force = false) {\n    if (this.debug) console.log('Lenis applyTransforms')\n\n    if (this.scrollbar) this.scrollbar.transform(this.progress)\n\n    if (this.smooth === true) {\n      if (this.sections.length > 0) {\n        this.sections.forEach(({ offsetTop, height, element }) => {\n          const top = offsetTop - this.lerpedScroll.y\n          const bottom = top + height\n\n          const OFFSET = 500\n\n          if (force || (top < this.windowHeight + OFFSET && bottom > -OFFSET)) {\n            // element.style.removeProperty(\"opacity\")\n            // element.style.removeProperty(\"pointerEvents\")\n            element.style.transform = `translate3d(0,${-this.lerpedScroll\n              .y}px,0)`\n          }\n          // else {\n          // element.style.removeProperty(\"transform\")\n          // element.style.opacity = 0\n          // element.style.pointerEvents = \"none\"\n          // }\n        })\n      } else {\n        this.content.style.transform = `translate3d(0,${-this.lerpedScroll\n          .y}px,0)`\n      }\n    }\n  }\n\n  get limit() {\n    return this.height - this.windowHeight\n  }\n\n  get progress() {\n    return this.lerpedScroll.y / this.limit\n  }\n}\n"],"names":["lerp","start","end","amt","truncate","value","decimals","parseFloat","toFixed","getTranslate","element","matrix","DOMMatrixReadOnly","window","getComputedStyle","getPropertyValue","translateX","m41","translateY","m42","BoundingClientRect","constructor","this","update","width","height","top","left","getBoundingClientRect","offsetTop","offsetLeft","Scrollbar","lenis","document","createElement","thumb","classList","add","appendChild","body","onWindowResize","addEventListener","onMouseDown","onMouseMove","onMouseUp","clientY","mouseDown","progress","windowHeight","scrollTo","limit","destroy","removeEventListener","offsetHeight","windowWidth","Math","min","documentElement","clientWidth","innerWidth","clientHeight","innerHeight","transform","style","Lenis","EventEmitter","wrapper","content","smooth","customScrollbar","debug","super","setMaxListeners","Infinity","setAttribute","toggle","preventTransforms","scrollbar","onWindowScroll","onKeyDown","focus","onFocus","onBlur","e","key","applyTransforms","console","log","removeProperty","removeAttribute","remove","scroll","x","scrollX","y","scrollY","lerpedScroll","sections","querySelectorAll","map","forEach","section","emit","raf","let","needsUpdate","force","length"],"mappings":"oPAQO,SAASA,KAAKC,EAAOC,EAAKC,GAC/B,OAAQ,EAAIA,GAAOF,EAAQE,EAAMD,EAG5B,SAASE,SAASC,EAAOC,GAC9B,OAAOC,WAAWF,EAAMG,QAAQF,ICTlC,SAASG,aAAaC,GACdC,EAAS,IAAIC,kBACjBC,OAAOC,iBAAiBJ,GAASK,iBAAiB,cAGpD,MAAO,CACLC,WAAYL,EAAOM,IACnBC,WAAYP,EAAOQ,WAIjBC,mBACJC,YAAYX,GACVY,KAAKZ,QAAUA,EACfY,KAAKC,SAGPA,SACE,GAAM,CAAEC,MAAAA,EAAOC,OAAAA,EAAQC,IAAAA,EAAKC,KAAAA,GAASL,KAAKZ,QAAQkB,wBAO5C,CAAEZ,WAAAA,EAAYE,WAAAA,IANpBI,KAAKE,MAAQA,EACbF,KAAKG,OAASA,EAKqBhB,aAAaa,KAAKZ,UAErDY,KAAKO,UAAYH,EAAMR,EACvBI,KAAKQ,WAAaH,EAAOX,SAIvBe,UACJV,YAAYW,GACVV,KAAKU,MAAQA,EAEbV,KAAKZ,QAAUuB,SAASC,cAAc,OACtCZ,KAAKa,MAAQF,SAASC,cAAc,OAEpCZ,KAAKZ,QAAQ0B,UAAUC,IAAI,mBAC3Bf,KAAKa,MAAMC,UAAUC,IAAI,yBAEzBf,KAAKZ,QAAQ4B,YAAYhB,KAAKa,OAE9BF,SAASM,KAAKD,YAAYhB,KAAKZ,SAE/BY,KAAKkB,iBAEL3B,OAAO4B,iBAAiB,SAAUnB,KAAKkB,gBAAgB,GACvDlB,KAAKZ,QAAQ+B,iBAAiB,YAAanB,KAAKoB,aAAa,GAC7D7B,OAAO4B,iBAAiB,YAAanB,KAAKqB,aAAa,GACvD9B,OAAO4B,iBAAiB,UAAWnB,KAAKsB,WAAW,GAGrDF,YAAc,CAAA,CAAGG,QAAAA,MACfvB,KAAKwB,WAAY,EAEXC,GAAqBzB,KAAK0B,aAEhCnC,OAAOoC,SAAS,EAAGF,EAAWzB,KAAKU,MAAMkB,QAG3CP,YAAc,CAAA,CAAGE,QAAAA,MACVvB,KAAKwB,YAEJC,EAAWF,EAAUvB,KAAK0B,aAEhCnC,OAAOoC,SAAS,EAAGF,EAAWzB,KAAKU,MAAMkB,SAG3CN,UAAY,KACVtB,KAAKwB,WAAY,GAGnBK,UACEtC,OAAOuC,oBAAoB,SAAU9B,KAAKkB,gBAAgB,GAC1DlB,KAAKZ,QAAQ0C,oBAAoB,YAAa9B,KAAKoB,aAAa,GAChE7B,OAAOuC,oBAAoB,YAAa9B,KAAKqB,aAAa,GAC1D9B,OAAOuC,oBAAoB,UAAW9B,KAAKsB,WAAW,GAGxDrB,SACED,KAAKG,OAASH,KAAKa,MAAMkB,aAG3Bb,eAAiB,KACflB,KAAKgC,YAAcC,KAAKC,IACtBvB,SAASwB,gBAAgBC,YACzB7C,OAAO8C,YAETrC,KAAK0B,aAAeO,KAAKC,IACvBvB,SAASwB,gBAAgBG,aACzB/C,OAAOgD,aAGTvC,KAAKC,UAGPuC,UAAUf,GACRzB,KAAKa,MAAM4B,MAAMD,wBACff,GAAYzB,KAAK0B,aAAe1B,KAAKG,QAAU,eAKhCuC,cAAcC,sBAAAA,QACjC5C,YAAY,CACV6C,QAAAA,EACAC,QAAAA,EACAnE,KAAAA,EAAO,GACPoE,OAAAA,GAAS,EACTC,gBAAAA,GAAkB,EAClBC,MAAAA,GAAQ,IAERC,QACAjD,KAAKkD,gBAAgBC,EAAAA,GAErBnD,KAAK+C,gBAAkBA,EACvB/C,KAAK8C,OAASA,EACd9C,KAAKtB,KAAOA,EACZsB,KAAK4C,QAAUA,EACf5C,KAAK6C,QAAUA,EACf7C,KAAKgD,MAAQA,EAGbhD,KAAKG,OAASH,KAAK6C,QAAQd,aACvB/B,KAAK8C,SAAQnC,SAASM,KAAKwB,MAAMtC,OAASH,KAAKG,OAAS,MAE5DH,KAAK4C,QAAQQ,aAAa,uBAAuB,GACjDpD,KAAK6C,QAAQO,aAAa,uBAAuB,GAEjDzC,SAASwB,gBAAgBrB,UAAUC,IAAI,SACvCJ,SAASwB,gBAAgBrB,UAAUuC,OAAO,eAAgBrD,KAAK8C,QAE/D9C,KAAKsD,mBAAoB,EAErBtD,KAAK+C,kBAAiB/C,KAAKuD,UAAY,IAAI9C,UAAUT,OAEzDA,KAAKkB,iBAEL3B,OAAO4B,iBAAiB,SAAUnB,KAAKwD,gBAAgB,GACvDjE,OAAO4B,iBAAiB,SAAUnB,KAAKkB,gBAAgB,GAGvD3B,OAAO4B,iBAAiB,UAAWnB,KAAKyD,WAAW,GAGnDzD,KAAK0D,OAAQ,EAEbnE,OAAO4B,iBAAiB,QAASnB,KAAK2D,SAAS,GAC/CpE,OAAO4B,iBAAiB,OAAQnB,KAAK4D,QAAQ,GAG/CH,UAAY,IACI,QAAVI,EAAEC,KACJ9D,KAAK+D,iBAAgB,IASzBJ,QAAU,KACJ3D,KAAKgD,OAAOgB,QAAQC,IAAI,iBAE5BjE,KAAK0D,OAAQ,EACb1D,KAAK+D,iBAAgB,IAGvBH,OAAS,KACH5D,KAAKgD,OAAOgB,QAAQC,IAAI,gBAE5BjE,KAAK0D,OAAQ,EACb1D,KAAK+D,iBAAgB,IAGvBlC,UACElB,SAASM,KAAKwB,MAAMyB,eAAe,UAEnC3E,OAAOuC,oBAAoB,SAAU9B,KAAKwD,gBAAgB,GAC1DjE,OAAOuC,oBAAoB,SAAU9B,KAAKkB,gBAAgB,GAC1D3B,OAAOuC,oBAAoB,UAAW9B,KAAKyD,WAAW,GAEtDlE,OAAOuC,oBAAoB,QAAS9B,KAAK2D,SAAS,GAClDpE,OAAOuC,oBAAoB,OAAQ9B,KAAK4D,QAAQ,GAEhD5D,KAAK4C,QAAQuB,gBAAgB,uBAAuB,GACpDnE,KAAK6C,QAAQsB,gBAAgB,uBAAuB,GAEpDxD,SAASwB,gBAAgBrB,UAAUsD,OAAO,SAC1CzD,SAASwB,gBAAgBrB,UAAUsD,OAAO,gBAEtCpE,KAAKuD,WAAWvD,KAAKuD,UAAU1B,UAGrC5B,SACMD,KAAKgD,OAAOgB,QAAQC,IAAI,gBAC5BjE,KAAKG,OAASH,KAAK6C,QAAQd,aAEvB/B,KAAK8C,SAAQnC,SAASM,KAAKwB,MAAMtC,OAASH,KAAKG,OAAS,MAE5DH,KAAKqE,OAAS,CACZC,EAAG/E,OAAOgF,QACVC,EAAGjF,OAAOkF,SAEZzE,KAAK0E,aAAe,CAClBJ,EAAG/E,OAAOgF,QACVC,EAAGjF,OAAOkF,SAGRzE,KAAKuD,WAAWvD,KAAKuD,UAAUtD,SAEnCD,KAAK2E,SAAW,IAAIhE,SAASiE,iBAAiB,0BAA0BC,IACtE,GAAa,IAAI/E,mBAAmBV,IAGtCY,KAAK2E,SAASG,QAAQ,IACpBC,EAAQ9E,WAGVD,KAAKgF,KAAK,SAAU,CAClBX,OAAQrE,KAAKqE,OACbK,aAAc1E,KAAK0E,eAGrB1E,KAAK+D,iBAAgB,GAGvB7C,eAAiB,KACXlB,KAAKgD,OAAOgB,QAAQC,IAAI,wBAE5BjE,KAAKgC,YAAcC,KAAKC,IACtBvB,SAASwB,gBAAgBC,YACzB7C,OAAO8C,YAETrC,KAAK0B,aAAeO,KAAKC,IACvBvB,SAASwB,gBAAgBG,aACzB/C,OAAOgD,aAETvC,KAAKC,UAGPuD,eAAiB,KACfxD,KAAKqE,OAAOC,EAAI/E,OAAOgF,QACvBvE,KAAKqE,OAAOG,EAAIjF,OAAOkF,SAEJ,IAAfzE,KAAK0D,QAAmC,IAAhB1D,KAAK8C,SAC/B9C,KAAK0E,aAAaJ,EAAItE,KAAKqE,OAAOC,EAClCtE,KAAK0E,aAAaF,EAAIxE,KAAKqE,OAAOG,EAElCxE,KAAK+D,iBAAgB,KAIzBkB,MACEC,IAAIC,GAAc,EAEdrG,SAASkB,KAAK0E,aAAaF,EAAG,KAAOxE,KAAKqE,OAAOG,GAEnDxE,KAAK0E,aAAaJ,EAAItE,KAAKqE,OAAOC,EAClCtE,KAAK0E,aAAaF,EAAIxE,KAAKqE,OAAOG,EAE7BxE,KAAKsD,oBACR6B,GAAc,EACdnF,KAAKsD,mBAAoB,KAG3BtD,KAAK0E,aAAaJ,EAAI5F,KAAKsB,KAAK0E,aAAaJ,EAAGtE,KAAKqE,OAAOC,EAAGtE,KAAKtB,MACpEsB,KAAK0E,aAAaF,EAAI9F,KAAKsB,KAAK0E,aAAaF,EAAGxE,KAAKqE,OAAOG,EAAGxE,KAAKtB,MAEpEyG,GAAc,EACdnF,KAAKsD,mBAAoB,GAGvB6B,IACFnF,KAAKgF,KAAK,SAAU,CAClBX,OAAQrE,KAAKqE,OACbK,aAAc1E,KAAK0E,eAErB1E,KAAK+D,mBAITA,gBAAgBqB,GAAQ,GAClBpF,KAAKgD,OAAOgB,QAAQC,IAAI,yBAExBjE,KAAKuD,WAAWvD,KAAKuD,UAAUf,UAAUxC,KAAKyB,WAE9B,IAAhBzB,KAAK8C,SACoB,EAAvB9C,KAAK2E,SAASU,OAChBrF,KAAK2E,SAASG,QAAQ,CAAA,CAAGvE,UAAAA,EAAWJ,OAAAA,EAAQf,QAAAA,MACpCgB,GAAkBJ,KAAK0E,aAAaF,GAKtCY,GAAUhF,EAAMJ,KAAK0B,aAFV,MAAA,IAFAtB,EAAMD,KAOnBf,EAAQqD,MAAMD,4BAA8BxC,KAAK0E,aAC9CF,YASPxE,KAAK6C,QAAQJ,MAAMD,4BAA8BxC,KAAK0E,aACnDF,UAKT5C,YACE,OAAO5B,KAAKG,OAASH,KAAK0B,aAG5BD,eACE,OAAOzB,KAAK0E,aAAaF,EAAIxE,KAAK4B"}