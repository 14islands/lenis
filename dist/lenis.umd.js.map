{"version":3,"file":"lenis.umd.js","sources":["../src/lenis.js","../src/maths.js"],"sourcesContent":["import EventEmitter from 'tiny-emitter'\r\nimport VirtualScroll from 'virtual-scroll'\r\nimport { clamp, lerp } from './maths.js'\r\n\r\nexport default class Lenis extends EventEmitter {\r\n  constructor({ lerp = 0.1, smooth = true } = {}) {\r\n    super()\r\n\r\n    this.lerp = lerp\r\n    this.smooth = smooth\r\n\r\n    window.addEventListener('scroll', this.onScroll, false)\r\n    window.addEventListener('resize', this.onWindowResize, false)\r\n\r\n    const platform =\r\n      navigator?.userAgentData?.platform || navigator?.platform || 'unknown'\r\n\r\n    // listen and normalize wheel event cross-browser\r\n    this.virtualScroll = new VirtualScroll({\r\n      firefoxMultiplier: 50,\r\n      mouseMultiplier: platform.indexOf('Win') > -1 ? 1 : 0.4,\r\n      useKeyboard: false,\r\n      useTouch: false,\r\n      passive: false,\r\n    })\r\n\r\n    this.virtualScroll.on(this.onVirtualScroll)\r\n\r\n    this.onWindowResize()\r\n    this.maxScroll = document.body.offsetHeight - this.windowHeight\r\n\r\n    // recalculate maxScroll when body height changes\r\n    this.resizeObserver = new ResizeObserver(this.onResize)\r\n    this.resizeObserver.observe(document.body)\r\n\r\n    this.targetScroll = this.scroll = window.scrollY\r\n  }\r\n\r\n  start() {\r\n    this.stopped = false\r\n  }\r\n\r\n  stop() {\r\n    this.stopped = true\r\n  }\r\n\r\n  destroy() {\r\n    window.removeEventListener('scroll', this.onScroll, false)\r\n    window.removeEventListener('resize', this.onWindowResize, false)\r\n    this.virtualScroll.destroy()\r\n    this.resizeObserver.disconnect()\r\n  }\r\n\r\n  onResize = (entries) => {\r\n    const entry = entries[0]\r\n    if (entry) {\r\n      const rect = entry.contentRect\r\n      this.maxScroll = rect.height - this.windowHeight\r\n    }\r\n  }\r\n\r\n  onWindowResize = () => {\r\n    this.windowHeight = window.innerHeight\r\n    this.windowWidth = window.innerWidth\r\n  }\r\n\r\n  onVirtualScroll = ({ deltaY, originalEvent: e }) => {\r\n    // detect potential nested scrollable elements\r\n    const path = e.path || e.composedPath?.()\r\n    const isNestedScroll = path\r\n      .filter((element) => element.tagName) // filter node elements\r\n      .find(\r\n        (element, i) =>\r\n          ['auto', 'scroll'].includes(getComputedStyle(element).overflowY) &&\r\n          element.scrollHeight > element.clientHeight\r\n      ) // filter scrollable elements\r\n\r\n    if (isNestedScroll) return\r\n\r\n    if (this.stopped) {\r\n      e.preventDefault()\r\n      return\r\n    }\r\n\r\n    if (this.smooth && !e.ctrlKey) e.preventDefault()\r\n\r\n    this.targetScroll -= deltaY\r\n    this.targetScroll = clamp(0, this.targetScroll, this.maxScroll)\r\n  }\r\n\r\n  raf() {\r\n    if (!this.smooth || this.stopped) return\r\n\r\n    // lerp scroll value\r\n    this.scroll = lerp(this.scroll, this.targetScroll, this.lerp)\r\n    if (Math.round(this.scroll) === Math.round(this.targetScroll)) {\r\n      this.scroll = this.targetScroll\r\n    }\r\n\r\n    if (this.scrolling) {\r\n      // scroll to lerped scroll value\r\n      window.scrollTo(0, this.scroll)\r\n      this.emit('scroll', { scroll: this.scroll })\r\n    }\r\n\r\n    this.scrolling = this.scroll !== this.targetScroll\r\n  }\r\n\r\n  onScroll = (e) => {\r\n    // if scrolling is false we can estimate you aren't scrolling with wheel (cmd+F, keyboard or whatever). So we must scroll to without any easing\r\n    if (!this.scrolling || !this.smooth) {\r\n      this.targetScroll = this.scroll = window.scrollY\r\n      this.emit('scroll', { scroll: this.scroll })\r\n    }\r\n  }\r\n\r\n  scrollTo(target, { offset = 0 } = {}) {\r\n    let y\r\n\r\n    if (typeof target === 'number') {\r\n      // Number\r\n      y = target\r\n    } else if (target === '#top') {\r\n      y = 0\r\n    } else if (target === '#bottom') {\r\n      y = this.maxScroll\r\n    } else {\r\n      let node\r\n\r\n      if (typeof target === 'string') {\r\n        // CSS selector\r\n        node = document.querySelector(target)\r\n      } else if (target?.nodeType) {\r\n        // Node element\r\n        node = target\r\n      } else {\r\n        return\r\n      }\r\n\r\n      if (!target) return\r\n      y = node.getBoundingClientRect().top + this.scroll\r\n    }\r\n\r\n    y += offset\r\n\r\n    this.targetScroll = y\r\n    this.scrolling = true\r\n    if (!this.smooth) {\r\n      this.scroll = y\r\n    }\r\n  }\r\n}\r\n","export function clamp(min, input, max) {\r\n  return input < min ? min : input > max ? max : input\r\n}\r\n\r\nexport function mapRange(in_min, in_max, input, out_min, out_max) {\r\n  return ((input - in_min) * (out_max - out_min)) / (in_max - in_min) + out_min\r\n}\r\n\r\nexport function lerp(start, end, amt) {\r\n  return (1 - amt) * start + amt * end\r\n}\r\n\r\nexport function truncate(value, decimals) {\r\n  return parseFloat(value.toFixed(decimals))\r\n}\r\n"],"names":["Lenis","_temp","_navigator","_navigator$userAgentD","_navigator2","_this","_ref","lerp","_ref$lerp","_ref$smooth","smooth","_EventEmitter","call","this","onResize","entries","entry","maxScroll","contentRect","height","windowHeight","onWindowResize","window","innerHeight","windowWidth","innerWidth","onVirtualScroll","deltaY","input","max","e","originalEvent","path","composedPath","filter","element","tagName","find","i","includes","getComputedStyle","overflowY","scrollHeight","clientHeight","stopped","preventDefault","ctrlKey","targetScroll","onScroll","scrolling","scroll","scrollY","emit","addEventListener","platform","navigator","userAgentData","virtualScroll","VirtualScroll","firefoxMultiplier","mouseMultiplier","indexOf","useKeyboard","useTouch","passive","on","document","body","offsetHeight","resizeObserver","observe","EventEmitter","start","stop","destroy","removeEventListener","disconnect","raf","amt","Math","round","scrollTo","target","y","offset","_temp2","_ref3$offset","node","querySelector","nodeType","getBoundingClientRect","top"],"mappings":"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"}